[2025-07-07 15:46:32,912][__main__][INFO] - Loading model and tokenizer...
Error executing job with overrides: []
Traceback (most recent call last):
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 409, in hf_raise_for_status
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-hf/resolve/main/config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/utils/hub.py", line 470, in cached_files
    hf_hub_download(
    ~~~~~~~~~~~~~~~^
        path_or_repo_id,
        ^^^^^^^^^^^^^^^^
    ...<10 lines>...
        local_files_only=local_files_only,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1008, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
        # Destination
    ...<14 lines>...
        force_download=force_download,
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1115, in _hf_hub_download_to_cache_dir
    _raise_on_head_call_error(head_call_error, force_download, local_files_only)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1645, in _raise_on_head_call_error
    raise head_call_error
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1533, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
        url=url, proxies=proxies, timeout=etag_timeout, headers=headers, token=token
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1450, in get_hf_file_metadata
    r = _request_wrapper(
        method="HEAD",
    ...<5 lines>...
        timeout=timeout,
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 286, in _request_wrapper
    response = _request_wrapper(
        method=method,
    ...<2 lines>...
        **params,
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 310, in _request_wrapper
    hf_raise_for_status(response)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 482, in hf_raise_for_status
    raise _format(HfHubHTTPError, str(e), response) from e
huggingface_hub.errors.HfHubHTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-hf/resolve/main/config.json (Request ID: Root=1-686c4e48-47a4efa0519dcb196877847a;7bea8efd-2ed4-449b-8ea0-5feef553a3b5)

Invalid credentials in Authorization header

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/nvme3/dipika/lie-detector/train/sft.py", line 439, in main
    model, tokenizer = load_model_and_tokenizer(cfg.model)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/mnt/nvme3/dipika/lie-detector/train/sft.py", line 197, in load_model_and_tokenizer
    tokenizer = AutoTokenizer.from_pretrained(
        config.model_name,
        trust_remote_code=config.trust_remote_code,
        padding_side="right"
            )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/models/auto/tokenization_auto.py", line 1002, in from_pretrained
    config = AutoConfig.from_pretrained(
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/models/auto/configuration_auto.py", line 1197, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/configuration_utils.py", line 608, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/configuration_utils.py", line 667, in _get_config_dict
    resolved_config_file = cached_file(
        pretrained_model_name_or_path,
    ...<10 lines>...
        _commit_hash=commit_hash,
    )
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/utils/hub.py", line 312, in cached_file
    file = cached_files(path_or_repo_id=path_or_repo_id, filenames=[filename], **kwargs)
  File "/mnt/nvme3/dipika/conda_envs/lie-detector/lib/python3.13/site-packages/transformers/utils/hub.py", line 553, in cached_files
    raise OSError(f"There was a specific connection error when trying to load {path_or_repo_id}:\n{e}") from e
OSError: There was a specific connection error when trying to load meta-llama/Llama-2-7b-hf:
401 Client Error: Unauthorized for url: https://huggingface.co/meta-llama/Llama-2-7b-hf/resolve/main/config.json (Request ID: Root=1-686c4e48-47a4efa0519dcb196877847a;7bea8efd-2ed4-449b-8ea0-5feef553a3b5)

Invalid credentials in Authorization header

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
